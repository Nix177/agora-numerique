<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Belles-Terres ‚Äî Atelier Conception</title>
  <meta name="description" content="Interface technique pour tester les prompts et les voix">
  <style>
    :root { color-scheme: light dark; }
    body { margin:0; font-family: system-ui, Segoe UI, Roboto, Arial, sans-serif; background: #222; color: #ddd; }
    header { padding: 12px 16px; border-bottom: 1px solid #444; display:flex; align-items:center; gap:12px; background: #111; }
    header h1 { font-size: 18px; margin:0; color: #ff8800; }
    
    /* Layout */
    main { display:grid; grid-template-columns: 1fr; gap:16px; padding:16px; max-width: 1200px; margin: 0 auto; }
    .panel { border:1px solid #444; border-radius:12px; padding:12px; background:#333; }
    
    /* Contr√¥les */
    .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom: 10px; }
    label { font-size: 14px; opacity:.9; }
    select, textarea, input[type="text"] { 
        width:100%; padding:8px; border-radius:8px; border:1px solid #555; 
        background:#222; color:white; font-family: inherit;
    }
    textarea { min-height: 120px; font-family: monospace; font-size: 13px; }
    
    /* Zone de Chat Technique */
    .chat { 
        height: 50vh; min-height: 300px; overflow:auto; display:flex; flex-direction:column; 
        gap:10px; padding:10px; border:1px solid #555; border-radius:12px; background: #1a1a1a; 
    }
    .msg { padding:10px 12px; border-radius:10px; white-space:pre-wrap; line-height:1.4; max-width: 85%; }
    .msg.user { align-self:flex-end; background:#0056b3; color: white; }
    .msg.bot  { align-self:flex-start; background:#2c3e50; border-left: 3px solid #ff8800; }
    
    /* Boutons */
    button { padding:8px 16px; border-radius:6px; border:none; background:#444; color:white; cursor:pointer; font-weight: bold; }
    button:hover { background:#555; }
    button#send { background: #28a745; }
    
    /* Onglets */
    .tabs { display:flex; gap:5px; border-bottom:1px solid #555; margin-bottom:10px; }
    .tab-btn { padding:8px 12px; border:1px solid #555; border-bottom:none; border-radius:8px 8px 0 0; cursor:pointer; background:#222; color: #888; }
    .tab-btn.active { background:#333; color: #ff8800; border-bottom: 1px solid #333; margin-bottom: -1px; }
    .tab { display:none; }
    .tab.active { display:block; }
    
    /* Avatar */
    .chat-panel { position: relative; }
    .persona-avatar {
      position:absolute; top:10px; right:12px; width:60px; height:60px;
      border-radius:50%; object-fit:cover; border:2px solid #ff8800;
    }
  </style>
</head>
<body>

  <header>
    <h1>üîß Atelier Belles-Terres</h1>
    <span style="opacity:0.6; font-size:0.9em;">Mode Conception & Test</span>
    <a href="index.html" style="margin-left:auto; color:#ff8800; text-decoration:none;">‚ñ∂ Retour au Jeu</a>
  </header>

  <main>
    <section class="panel chat-panel">
      <img id="avatar" class="persona-avatar" alt="avatar" src="">
      
      <div class="row">
        <div style="flex:1;">
            <label>Persona:</label>
            <select id="persona"></select>
        </div>
        <div style="flex:1;">
            <label>Mod√®le:</label>
            <select id="model"></select>
        </div>
        <div style="display:flex; align-items:center; gap:5px; padding-top:20px;">
            <input type="checkbox" id="tts"> <label for="tts">Voix Active</label>
        </div>
      </div>

      <div id="chat" class="chat"></div>

      <div class="row" style="margin-top:10px;">
        <textarea id="input" placeholder="Testez vos prompts ici... (Entr√©e pour envoyer)"></textarea>
      </div>
      
      <div class="row">
        <button id="send">Envoyer</button>
        <button id="reset" style="background:#d9534f;">Reset M√©moire</button>
        <button id="save">Log R2</button>
      </div>
    </section>

    <section class="panel" id="editors">
      <div class="tabs">
        <button class="tab-btn active" data-tab="world-tab">Monde (JSON)</button>
        <button class="tab-btn" data-tab="personas-tab">Personas (JSON)</button>
        <button class="tab-btn" data-tab="prompt-tab">Syst√®me (Prompt)</button>
      </div>

      <div class="tab active" id="world-tab">
        <textarea id="world" spellcheck="false"></textarea>
        <p style="font-size:0.8em; color:#aaa;">Modifiez le contexte global (Lieu, Faits) ici pour tester.</p>
      </div>

      <div class="tab" id="personas-tab">
        <textarea id="personasEditor" spellcheck="false"></textarea>
        <p style="font-size:0.8em; color:#aaa;">√âditez les profils des robots √† la vol√©e.</p>
      </div>

      <div class="tab" id="prompt-tab">
        <textarea id="promptEditor" spellcheck="false"></textarea>
        <p style="font-size:0.8em; color:#aaa;">Le prompt syst√®me g√©n√©r√© par <code>prompt.js</code>.</p>
      </div>
    </section>
  </main>

  <script type="module" src="./assets/app.js"></script>

  <script>
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabs    = document.querySelectorAll('.tab');
    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.dataset.tab;
        tabBtns.forEach(b => b.classList.toggle('active', b === btn));
        tabs.forEach(t => t.classList.toggle('active', t.id === id));
      });
    });
  </script>

</body>
</html>
